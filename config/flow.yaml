name: "Default flow"

#    Possible steps:
 #   * 1 start and end

  #  (SISO)
   # * guard rails
    #* model - calls llm with fallback recovery

    #(SIMO)
    #* split - splits flow into multiple parallel branches

   # (MISO)
   # * join - it joins multiple branches - should be used to join filter, switch and split results
   #   it has inputs field because inputs can be reordered - maybe delete

#TODO remove additional fields, replace outputs with inputs, rewrite config, disabled
steps:

  - id: "Trim query"
    type: transform
    expression:
      language: expr
      expression: "trim(input)"
    input: "start"

  - id: "Guard rail #1"
    type: plugin
    path: "some/fancy/path/guardRailPlugin.so"
    output: "Filter based on length"

  - id: "Filter based on length"
    type: filter
    expression:
      language: expr
      expression: "len(input) <= 500"
    onFalse: "standard-whatever-flow"
    output: "choice"

  - id: "standard-whatever-flow"
    type: flow
    path: "some/fancy/path/template"
    output: "split"

  - id: "split"
    type: split
    output: [ "guard rail #2", "some external api" ]

  - id: "guard rail #2"
    type: guardrails
    path: "some/fancy/path/guardRail2Plugin.so"
    output: "Gemini 3"

  - id: "Gemini 3"
    type: model
    model: gemini-3.0
    output: "union"

  - id: "some external api"
    type: plugin
    path: "some/fancy/path/someExternalApiPlugin.so"
    output: "union"

  - id: "choice"
    type: switch
    additionalFields:
      description: null
      layoutData:
        x: -357
        y: 35
    defaultOutput: "union"
    output:
      - expression:
          language: expr
          expression: "contains(input, \"newest chatGPT\")"
        step: "gpt-5.0"
      - expression:
          language: expr
          expression: "contains(input, \"chatGPT\")"
        step: "gpt-4.5"

  - id: "gpt-5.0"
    type: model
    model: gpt-5.0
    additionalFields:
      description: null
      layoutData:
        x: -489
        y: 216
    output: "union"

  - id: "gpt-4.5"
    type: model
    model: gpt-4.5
    additionalFields:
      description: null
      layoutData:
        x: -489
        y: 216
    output: "union"

  - id: "union"
    type: join
    additionalFields:
      description: null
      layoutData:
        x: -193
        y: 512
    inputs: [ "Gemini 3", "gpt-5.0", "gpt-4.5", "some external api", "choice" ]

